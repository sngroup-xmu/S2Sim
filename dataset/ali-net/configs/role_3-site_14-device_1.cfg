!
version 15.2
!
service timestamps debug datetime msec
!
service timestamps log datetime msec
!
boot-start-marker
!
boot-end-marker
!
no aaa new-model
!
ip cef
!
no ipv6 cef
!
multilink bundle-name authenticated
!
ip forward-protocol nd
!
no ip http server
!
no ip http secure-server
!
ip bgp-community new-format
!
hostname role_3-site_14-device_1
!
interface GigabitEthernet0/1
 ip address 10.0.1.57 255.255.255.252
 description role_1-site_14-device_0
!
interface GigabitEthernet0/2
 ip address 10.0.2.53 255.255.255.252
 description role_1-site_17-device_0
!
interface GigabitEthernet0/4
 ip address 10.0.4.88 255.255.255.252
 description role_3-site_17-device_1
!
interface GigabitEthernet0/5
 ip address 10.0.4.92 255.255.255.252
 description role_1-site_10-device_0
!
interface GigabitEthernet0/3
 ip address 10.0.3.97 255.255.255.252
 description role_1-site_12-device_0
!

!
interface loopback 0
 ip address 82.163.100.120 255.255.255.255
!
router bgp 153
 bgp router-id 82.163.100.120
 neighbor group_1 peer-group
 neighbor 163.154.129.166 peer-group group_1
 neighbor 163.154.129.166 remote-as 128
 neighbor 163.154.129.166 description role_1-site_14-device_0
 neighbor 163.154.129.166 update-source lo0
 neighbor 163.154.129.170 peer-group group_1
 neighbor 163.154.129.170 remote-as 130
 neighbor 163.154.129.170 description role_1-site_17-device_0
 neighbor 163.154.129.170 update-source lo0
 neighbor group_1 send-community both
 neighbor group_0 peer-group
 neighbor 82.163.100.121 peer-group group_0
 neighbor 82.163.100.121 remote-as 157
 neighbor 82.163.100.121 description role_3-site_17-device_1
 neighbor 82.163.100.121 update-source lo0
 neighbor group_0 send-community both
 neighbor group_2 peer-group
 neighbor 82.163.100.89 peer-group group_2
 neighbor 82.163.100.89 remote-as 127
 neighbor 82.163.100.89 description role_1-site_12-device_0
 neighbor 82.163.100.89 update-source lo0
 neighbor 82.163.100.88 peer-group group_2
 neighbor 82.163.100.88 remote-as 126
 neighbor 82.163.100.88 description role_1-site_10-device_0
 neighbor 82.163.100.88 update-source lo0
 neighbor group_2 send-community both
 neighbor group_1 route-map policy_0 in
 neighbor group_2 route-map policy_2 in
 neighbor group_1 route-map policy_1 out
 neighbor group_0 route-map policy_3 out
 neighbor group_2 route-map policy_4 out
!
route-map policy_0 permit 10
 match ip address prefix-list 1
route-map policy_0 permit 20

 match protocol bgp
route-map policy_0 permit 30

 match protocol bgp
route-map policy_0 permit 40

 match community 4
 match protocol bgp
route-map policy_0 permit 50

 match community 5
 match protocol bgp
route-map policy_0 permit 60

 match protocol bgp
route-map policy_0 permit 70

 match community 10
 match community 9
 match protocol bgp
route-map policy_0 permit 80

 match community 14
 match community 13
 match community 15
 match community 11
 match community 12
 match community 16
 match protocol bgp
route-map policy_0 permit 90

 match protocol bgp
route-map policy_0 permit 100
 match ip address prefix-list 18
 match protocol bgp
route-map policy_0 permit 110
 match ip address prefix-list 19
 match protocol bgp
route-map policy_0 permit 120

 match community 20
 match protocol bgp
route-map policy_0 permit 130
 match ip address prefix-list 21
route-map policy_0 permit 140

 match community 22
 set local-preference 100
route-map policy_0 deny 150

!

route-map policy_2 deny 10
 match ip address prefix-list 28
route-map policy_2 permit 20

 match protocol bgp
route-map policy_2 permit 30

 match protocol bgp
route-map policy_2 permit 40

 match community 4
 match protocol bgp
route-map policy_2 permit 50

 match community 5
 match protocol bgp
route-map policy_2 permit 60

 match protocol bgp
route-map policy_2 permit 70

 match community 10
 match community 9
 match protocol bgp
route-map policy_2 permit 80

 match community 14
 match community 13
 match community 15
 match community 11
 match community 12
 match community 16
 match protocol bgp
route-map policy_2 permit 90

 match protocol bgp
route-map policy_2 permit 100
 match ip address prefix-list 18
 match protocol bgp
route-map policy_2 permit 110
 match ip address prefix-list 19
 match protocol bgp
route-map policy_2 permit 120

 match community 20
 match protocol bgp
route-map policy_2 permit 130
 match ip address prefix-list 21
route-map policy_2 permit 140

 match community 22
 set local-preference 100
route-map policy_2 deny 150

!

route-map policy_1 permit 20
 match ip address prefix-list 26
 set ip next-hop 82.163.100.120
route-map policy_1 permit 30
 match ip address prefix-list 27
 set ip next-hop 82.163.100.120
 set community 23118:65610 23118:8000 additive
route-map policy_1 permit 40

 set ip next-hop 82.163.100.120
 set community 23118:65610 23118:8000 additive
route-map policy_1 permit 50

 match protocol bgp
 set ip next-hop 82.163.100.120
!

route-map policy_4 permit 20
 match ip address prefix-list 29
 set ip next-hop 82.163.100.120
route-map policy_4 permit 30
 match ip address prefix-list 27
 set ip next-hop 82.163.100.120
 set community 23118:65610 23118:8000 additive
route-map policy_4 permit 40

 set ip next-hop 82.163.100.120
 set community 23118:65610 23118:8000 additive
route-map policy_4 permit 50

 match protocol bgp
 set ip next-hop 82.163.100.120
!

route-map policy_3 permit 10

 set ip next-hop 82.163.100.120
!
ip prefix-list 1 seq 10 permit 0.0.0.0/0 ge 0 le 0
!
ip community-list 4 permit ^(23111:39...)$
!
ip community-list 5 permit ^(23118:76...)$
!
ip community-list 10 permit ^(23118:39...)$
!
ip community-list 9 permit 94129:23111
!
ip community-list 14 permit 23118:624..$
!
ip community-list 13 permit 23118:629..$
!
ip community-list 15 permit 23118:622..$
!
ip community-list 11 permit 23118:655..$
!
ip community-list 12 permit 23118:625..$
!
ip community-list 16 permit 23118:645..$
!
ip prefix-list 18 seq 10 permit 113.146.0.0/16 ge 16 le 32
ip prefix-list 18 seq 20 permit 113.2.0.0/16 ge 16 le 32
ip prefix-list 18 seq 30 permit 113.213.0.0/16 ge 16 le 32
ip prefix-list 18 seq 40 permit 113.27.0.0/16 ge 16 le 32
!
ip prefix-list 19 seq 10 permit 163.154.128.0/24 ge 24 le 32
ip prefix-list 19 seq 20 permit 163.154.129.0/24 ge 24 le 32
ip prefix-list 19 seq 30 permit 82.163.64.0/24 ge 24 le 32
ip prefix-list 19 seq 40 permit 82.163.65.0/24 ge 24 le 32
ip prefix-list 19 seq 50 permit 82.163.68.0/22 ge 22 le 32
ip prefix-list 19 seq 60 permit 82.163.100.0/24 ge 24 le 32
ip prefix-list 19 seq 70 permit 82.163.101.0/24 ge 24 le 32
!
ip community-list 20 permit ^(23118:656..)$
!
ip prefix-list 21 seq 10 permit 64.55.96.0/19 ge 19 le 19
ip prefix-list 21 seq 20 permit 64.55.112.0/21 ge 21 le 21
!
ip community-list 22 permit 35607:4606
!
ip prefix-list 28 seq 10 permit 0.0.0.0/0 ge 0 le 0
!
ip prefix-list 26 seq 10 permit 0.0.0.0/0 ge 0 le 0
!
ip prefix-list 27 seq 10 permit 130.169.0.0/18 ge 18 le 18
ip prefix-list 27 seq 20 permit 130.173.0.0/17 ge 17 le 17
ip prefix-list 27 seq 30 permit 130.200.128.0/17 ge 17 le 17
ip prefix-list 27 seq 40 permit 64.55.117.0/24 ge 24 le 24
ip prefix-list 27 seq 50 permit 130.150.0.0/16 ge 16 le 16
ip prefix-list 27 seq 60 permit 130.150.0.0/17 ge 17 le 17
ip prefix-list 27 seq 70 permit 130.150.128.0/17 ge 17 le 17
ip prefix-list 27 seq 80 permit 130.169.82.0/23 ge 23 le 23
ip prefix-list 27 seq 90 permit 130.220.0.0/16 ge 16 le 16
ip prefix-list 27 seq 100 permit 20.67.64.0/18 ge 18 le 18
ip prefix-list 27 seq 110 permit 130.181.0.0/16 ge 16 le 16
!
ip prefix-list 29 seq 10 permit 0.0.0.0/0 ge 0 le 0
!
ip route 163.154.129.166 255.255.255.255 10.0.1.56
!
ip route 163.154.129.170 255.255.255.255 10.0.2.52
!
ip route 82.163.100.121 255.255.255.255 10.0.4.89
!
ip route 82.163.100.88 255.255.255.255 10.0.4.93
!
ip route 82.163.100.89 255.255.255.255 10.0.3.96
!

